rule GenericTrojan
{
    meta:
        description = "Detects generic trojan behavior"
        author = "Your Name"
        date = "2024-09-22"
    strings:
        $s1 = "CreateRemoteThread" nocase
        $s2 = "OpenProcess" nocase
        $s3 = "VirtualAlloc" nocase
        $s4 = "Inject" nocase
    condition:
        any of ($s1, $s2, $s3, $s4)
}

rule Ransomware
{
    meta:
        description = "Detects common ransomware indicators"
        author = "Your Name"
        date = "2024-09-22"
    strings:
        $ransom_note = "Your files have been encrypted" nocase
        $encryption_key = "AES" nocase
        $file_extension = ".locked"
    condition:
        any of ($ransom_note, $encryption_key) and $file_extension
}

rule Backdoor
{
    meta:
        description = "Detects common backdoor signatures"
        author = "Your Name"
        date = "2024-09-22"
    strings:
        $s1 = "cmd.exe" nocase
        $s2 = "powershell" nocase
        $s3 = "reverse shell" nocase
    condition:
        any of them
}

rule Keylogger
{
    meta:
        description = "Detects keylogger behavior"
        author = "Your Name"
        date = "2024-09-22"
    strings:
        $keylog1 = "getAsyncKeyState" nocase
        $keylog2 = "WriteFile" nocase
        $keylog3 = "OpenProcess" nocase
    condition:
        any of ($keylog1, $keylog2, $keylog3)
}

rule Adware
{
    meta:
        description = "Detects common adware signatures"
        author = "Your Name"
        date = "2024-09-22"
    strings:
        $ad1 = "Ads by" nocase
        $ad2 = "This product is sponsored" nocase
        $ad3 = "install now" nocase
    condition:
        any of them
}

rule RansomwareExample
{
    meta:
        description = "Detects a common ransomware variant"
        author = "Your Name"
        date = "2024-09-22"
        hash = "example_hash_value"

    strings:
        $s1 = "encrypted_file" nocase
        $s2 = ".lock" nocase
        $s3 = "ransom_note.txt" nocase
        $s4 = "decrypt" nocase

    condition:
        any of ($s*) and filesize < 200MB
}
